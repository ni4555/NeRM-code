Optimize heuristics by minimizing loops, maximizing vectorization, and incorporating capacity constraints with explicit penalties.
